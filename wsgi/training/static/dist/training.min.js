(function(f){function A(a,b,d){var c=a[0],g=/er/.test(d)?_indeterminate:/bl/.test(d)?n:k,e=d==_update?{checked:c[k],disabled:c[n],indeterminate:"true"==a.attr(_indeterminate)||"false"==a.attr(_determinate)}:c[g];if(/^(ch|di|in)/.test(d)&&!e)x(a,g);else if(/^(un|en|de)/.test(d)&&e)q(a,g);else if(d==_update)for(var f in e)e[f]?x(a,f,!0):q(a,f,!0);else if(!b||"toggle"==d){if(!b)a[_callback]("ifClicked");e?c[_type]!==r&&q(a,g):x(a,g)}}function x(a,b,d){var c=a[0],g=a.parent(),e=b==k,u=b==_indeterminate,v=b==n,s=u?_determinate:e?y:"enabled",F=l(a,s+t(c[_type])),B=l(a,b+t(c[_type]));if(!0!==c[b]){if(!d&&b==k&&c[_type]==r&&c.name){var w=a.closest("form"),p='input[name="'+c.name+'"]',p=w.length?w.find(p):f(p);p.each(function(){this!==c&&f(this).data(m)&&q(f(this),b)})}u?(c[b]=!0,c[k]&&q(a,k,"force")):(d||(c[b]=!0),e&&c[_indeterminate]&&q(a,_indeterminate,!1));D(a,e,b,d)}c[n]&&l(a,_cursor,!0)&&g.find("."+C).css(_cursor,"default");g[_add](B||l(a,b)||"");g.attr("role")&&!u&&g.attr("aria-"+(v?n:k),"true");g[_remove](F||l(a,s)||"")}function q(a,b,d){var c=a[0],g=a.parent(),e=b==k,f=b==_indeterminate,m=b==n,s=f?_determinate:e?y:"enabled",q=l(a,s+t(c[_type])),r=l(a,b+t(c[_type]));if(!1!==c[b]){if(f||!d||"force"==d)c[b]=!1;D(a,e,s,d)}!c[n]&&l(a,_cursor,!0)&&g.find("."+C).css(_cursor,"pointer");g[_remove](r||l(a,b)||"");g.attr("role")&&!f&&g.attr("aria-"+(m?n:k),"false");g[_add](q||l(a,s)||"")}function E(a,b){if(a.data(m)){a.parent().html(a.attr("style",a.data(m).s||""));if(b)a[_callback](b);a.off(".i").unwrap();f(_label+'[for="'+a[0].id+'"]').add(a.closest(_label)).off(".i")}}function l(a,b,f){if(a.data(m))return a.data(m).o[b+(f?"":"Class")]}function t(a){return a.charAt(0).toUpperCase()+a.slice(1)}function D(a,b,f,c){if(!c){if(b)a[_callback]("ifToggled");a[_callback]("ifChanged")[_callback]("if"+t(f))}}var m="iCheck",C=m+"-helper",r="radio",k="checked",y="un"+k,n="disabled";_determinate="determinate";_indeterminate="in"+_determinate;_update="update";_type="type";_click="click";_touch="touchbegin.i touchend.i";_add="addClass";_remove="removeClass";_callback="trigger";_label="label";_cursor="cursor";_mobile=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini|silk/i.test(navigator.userAgent);f.fn[m]=function(a,b){var d='input[type="checkbox"], input[type="'+r+'"]',c=f(),g=function(a){a.each(function(){var a=f(this);c=a.is(d)?c.add(a):c.add(a.find(d))})};if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(a))return a=a.toLowerCase(),g(this),c.each(function(){var c=f(this);"destroy"==a?E(c,"ifDestroyed"):A(c,!0,a);f.isFunction(b)&&b()});if("object"!=typeof a&&a)return this;var e=f.extend({checkedClass:k,disabledClass:n,indeterminateClass:_indeterminate,labelHover:!0},a),l=e.handle,v=e.hoverClass||"hover",s=e.focusClass||"focus",t=e.activeClass||"active",B=!!e.labelHover,w=e.labelHoverClass||"hover",p=(""+e.increaseArea).replace("%","")|0;if("checkbox"==l||l==r)d='input[type="'+l+'"]';-50>p&&(p=-50);g(this);return c.each(function(){var a=f(this);E(a);var c=this,b=c.id,g=-p+"%",d=100+2*p+"%",d={position:"absolute",top:g,left:g,display:"block",width:d,height:d,margin:0,padding:0,background:"#fff",border:0,opacity:0},g=_mobile?{position:"absolute",visibility:"hidden"}:p?d:{position:"absolute",opacity:0},l="checkbox"==c[_type]?e.checkboxClass||"icheckbox":e.radioClass||"i"+r,z=f(_label+'[for="'+b+'"]').add(a.closest(_label)),u=!!e.aria,y=m+"-"+Math.random().toString(36).substr(2,6),h='<div class="'+l+'" '+(u?'role="'+c[_type]+'" ':"");u&&z.each(function(){h+='aria-labelledby="';this.id?h+=this.id:(this.id=y,h+=y);h+='"'});h=a.wrap(h+"/>")[_callback]("ifCreated").parent().append(e.insert);d=f('<ins class="'+C+'"/>').css(d).appendTo(h);a.data(m,{o:e,s:a.attr("style")}).css(g);e.inheritClass&&h[_add](c.className||"");e.inheritID&&b&&h.attr("id",m+"-"+b);"static"==h.css("position")&&h.css("position","relative");A(a,!0,_update);if(z.length)z.on(_click+".i mouseover.i mouseout.i "+_touch,function(b){var d=b[_type],e=f(this);if(!c[n]){if(d==_click){if(f(b.target).is("a"))return;A(a,!1,!0)}else B&&(/ut|nd/.test(d)?(h[_remove](v),e[_remove](w)):(h[_add](v),e[_add](w)));if(_mobile)b.stopPropagation();else return!1}});a.on(_click+".i focus.i blur.i keyup.i keydown.i keypress.i",function(b){var d=b[_type];b=b.keyCode;if(d==_click)return!1;if("keydown"==d&&32==b)return c[_type]==r&&c[k]||(c[k]?q(a,k):x(a,k)),!1;if("keyup"==d&&c[_type]==r)!c[k]&&x(a,k);else if(/us|ur/.test(d))h["blur"==d?_remove:_add](s)});d.on(_click+" mousedown mouseup mouseover mouseout "+_touch,function(b){var d=b[_type],e=/wn|up/.test(d)?t:v;if(!c[n]){if(d==_click)A(a,!1,!0);else{if(/wn|er|in/.test(d))h[_add](e);else h[_remove](e+" "+t);if(z.length&&B&&e==v)z[/ut|nd/.test(d)?_remove:_add](w)}if(_mobile)b.stopPropagation();else return!1}})})}})(window.jQuery||window.Zepto);+function(a){"use strict";var b=window.navigator.appName=="Microsoft Internet Explorer",c=function(b,c){this.$element=a(b),this.$input=this.$element.find(":file");if(this.$input.length===0)return;this.name=this.$input.attr("name")||c.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),this.$hidden.length===0&&(this.$hidden=a('<input type="hidden">').insertBefore(this.$input)),this.$preview=this.$element.find(".fileinput-preview");var d=this.$preview.css("height");this.$preview.css("display")!=="inline"&&d!=="0px"&&d!=="none"&&this.$preview.css("line-height",d),this.original={exists:this.$element.hasClass("fileinput-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.listen()};c.prototype.listen=function(){this.$input.on("change.bs.fileinput",a.proxy(this.change,this)),a(this.$input[0].form).on("reset.bs.fileinput",a.proxy(this.reset,this)),this.$element.find('[data-trigger="fileinput"]').on("click.bs.fileinput",a.proxy(this.trigger,this)),this.$element.find('[data-dismiss="fileinput"]').on("click.bs.fileinput",a.proxy(this.clear,this))},c.prototype.change=function(b){var c=b.target.files===undefined?b.target&&b.target.value?[{name:b.target.value.replace(/^.+\\/,"")}]:[]:b.target.files;b.stopPropagation();if(c.length===0){this.clear();return}this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name);var d=c[0];if(this.$preview.length>0&&(typeof d.type!="undefined"?d.type.match(/^image\/(gif|png|jpeg)$/):d.name.match(/\.(gif|png|jpe?g)$/i))&&typeof FileReader!="undefined"){var e=new FileReader,f=this.$preview,g=this.$element;e.onload=function(b){var e=a("<img>");e[0].src=b.target.result,c[0].result=b.target.result,g.find(".fileinput-filename").text(d.name),f.css("max-height")!="none"&&e.css("max-height",parseInt(f.css("max-height"),10)-parseInt(f.css("padding-top"),10)-parseInt(f.css("padding-bottom"),10)-parseInt(f.css("border-top"),10)-parseInt(f.css("border-bottom"),10)),f.html(e),g.addClass("fileinput-exists").removeClass("fileinput-new"),g.trigger("change.bs.fileinput",c)},e.readAsDataURL(d)}else this.$element.find(".fileinput-filename").text(d.name),this.$preview.text(d.name),this.$element.addClass("fileinput-exists").removeClass("fileinput-new"),this.$element.trigger("change.bs.fileinput")},c.prototype.clear=function(a){a&&a.preventDefault(),this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name","");if(b){var c=this.$input.clone(!0);this.$input.after(c),this.$input.remove(),this.$input=c}else this.$input.val("");this.$preview.html(""),this.$element.find(".fileinput-filename").text(""),this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),a!==undefined&&(this.$input.trigger("change"),this.$element.trigger("clear.bs.fileinput"))},c.prototype.reset=function(){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.$element.find(".fileinput-filename").text(""),this.original.exists?this.$element.addClass("fileinput-exists").removeClass("fileinput-new"):this.$element.addClass("fileinput-new").removeClass("fileinput-exists"),this.$element.trigger("reset.bs.fileinput")},c.prototype.trigger=function(a){this.$input.trigger("click"),a.preventDefault()};var d=a.fn.fileinput;a.fn.fileinput=function(b){return this.each(function(){var d=a(this),e=d.data("bs.fileinput");e||d.data("bs.fileinput",e=new c(this,b)),typeof b=="string"&&e[b]()})},a.fn.fileinput.Constructor=c,a.fn.fileinput.noConflict=function(){return a.fn.fileinput=d,this},a(document).on("click.fileinput.data-api",'[data-provides="fileinput"]',function(b){var c=a(this);if(c.data("bs.fileinput"))return;c.fileinput(c.data());var d=a(b.target).closest('[data-dismiss="fileinput"],[data-trigger="fileinput"]');d.length>0&&(b.preventDefault(),d.trigger("click.bs.fileinput"))})}(window.jQuery);!function(a,b){"use strict";function c(b){b=a.extend({},F,b||{}),null===E&&(E=a("body"));for(var c=a(this),e=0,f=c.length;f>e;e++)d(c.eq(e),b);return c}function d(b,c){if(!b.hasClass("selecter-element")){c=a.extend({},c,b.data("selecter-options")),c.external&&(c.links=!0);var d=b.find("option, optgroup"),g=d.filter("option"),h=g.filter(":selected"),j=h.length>0?g.index(h):1,k="div";c.tabIndex=b[0].tabIndex,b[0].tabIndex=-1,c.multiple=b.prop("multiple"),c.disabled=b.is(":disabled");var q="",s="";s+="<"+k+' class="selecter '+c.customClass,C?s+=" mobile":c.cover&&(s+=" cover"),s+=c.multiple?" multiple":" closed",c.disabled&&(s+=" disabled"),s+='" tabindex="'+c.tabIndex+'">',s+="</"+k+">",c.multiple||(q+='<span class="selecter-selected'+(""!==c.label?" placeholder":"")+'">',q+=a("<span></span>").text(v(""!==h.text()?h.text():c.label,c.trim)).html(),q+="</span>"),q+='<div class="selecter-options">',q+="</div>",b.addClass("selecter-element").wrap(s).after(q);var t=b.parent(".selecter"),u=a.extend({$select:b,$allOptions:d,$options:g,$selecter:t,$selected:t.find(".selecter-selected"),$itemsWrapper:t.find(".selecter-options"),index:-1,guid:z++},c);e(u),u.multiple||r(j,u),void 0!==a.fn.scroller&&u.$itemsWrapper.scroller(),u.$selecter.on("touchstart.selecter",".selecter-selected",u,f).on("click.selecter",".selecter-selected",u,i).on("click.selecter",".selecter-item",u,m).on("close.selecter",u,l).data("selecter",u),u.$select.on("change.selecter",u,n),C||(u.$selecter.on("focus.selecter",u,o).on("blur.selecter",u,p),u.$select.on("focus.selecter",u,function(a){a.data.$selecter.trigger("focus")}))}}function e(b){for(var c="",d=b.links?"a":"span",e=0,f=0,g=b.$allOptions.length;g>f;f++){var h=b.$allOptions.eq(f);if("OPTGROUP"===h[0].tagName)c+='<span class="selecter-group',h.is(":disabled")&&(c+=" disabled"),c+='">'+h.attr("label")+"</span>";else{var i=h.val();h.attr("value")||h.attr("value",i),c+="<"+d+' class="selecter-item',h.is(":selected")&&(c+=" selected"),h.is(":disabled")&&(c+=" disabled"),c+='" ',c+=b.links?'href="'+i+'"':'data-value="'+i+'"',c+=">"+a("<span></span>").text(v(h.text(),b.trim)).html()+"</"+d+">",e++}}b.$itemsWrapper.html(c),b.$items=b.$selecter.find(".selecter-item")}function f(a){a.stopPropagation();var b=a.data,c=a.originalEvent;y(b.timer),b.touchStartX=c.touches[0].clientX,b.touchStartY=c.touches[0].clientY,b.$selecter.on("touchmove.selecter",".selecter-selected",b,g).on("touchend.selecter",".selecter-selected",b,h)}function g(a){var b=a.data,c=a.originalEvent;(Math.abs(c.touches[0].clientX-b.touchStartX)>10||Math.abs(c.touches[0].clientY-b.touchStartY)>10)&&b.$selecter.off("touchmove.selecter touchend.selecter")}function h(a){var b=a.data;b.$selecter.off("touchmove.selecter touchend.selecter click.selecter"),b.timer=x(b.timer,1e3,function(){b.$selecter.on("click.selecter",".selecter-selected",b,i)}),i(a)}function i(c){c.preventDefault(),c.stopPropagation();var d=c.data;if(!d.$select.is(":disabled"))if(a(".selecter").not(d.$selecter).trigger("close.selecter",[d]),C&&!D){var e=d.$select[0];if(b.document.createEvent){var f=b.document.createEvent("MouseEvents");f.initMouseEvent("mousedown",!1,!0,b,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(f)}else e.fireEvent&&e.fireEvent("onmousedown")}else d.$selecter.hasClass("closed")?j(c):d.$selecter.hasClass("open")&&l(c)}function j(a){a.preventDefault(),a.stopPropagation();var b=a.data;if(!b.$selecter.hasClass("open")){{var c=b.$selecter.offset(),d=E.outerHeight(),e=b.$itemsWrapper.outerHeight(!0);b.index>=0?b.$items.eq(b.index).position():{left:0,top:0}}c.top+e>d&&b.$selecter.addClass("bottom"),b.$itemsWrapper.show(),b.$selecter.removeClass("closed").addClass("open"),E.on("click.selecter-"+b.guid,":not(.selecter-options)",b,k),s(b)}}function k(b){b.preventDefault(),b.stopPropagation(),0===a(b.currentTarget).parents(".selecter").length&&l(b)}function l(a){a.preventDefault(),a.stopPropagation();var b=a.data;b.$selecter.hasClass("open")&&(b.$itemsWrapper.hide(),b.$selecter.removeClass("open bottom").addClass("closed"),E.off(".selecter-"+b.guid))}function m(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=b.data;if(!d.$select.is(":disabled")){if(d.$itemsWrapper.is(":visible")){var e=d.$items.index(c);e!==d.index&&(r(e,d),t(d))}d.multiple||l(b)}}function n(b,c){var d=a(this),e=b.data;if(!c&&!e.multiple){var f=e.$options.index(e.$options.filter("[value='"+w(d.val())+"']"));r(f,e),t(e)}}function o(b){b.preventDefault(),b.stopPropagation();var c=b.data;c.$select.is(":disabled")||c.multiple||(c.$selecter.addClass("focus").on("keydown.selecter-"+c.guid,c,q),a(".selecter").not(c.$selecter).trigger("close.selecter",[c]))}function p(b){b.preventDefault(),b.stopPropagation();var c=b.data;c.$selecter.removeClass("focus").off("keydown.selecter-"+c.guid),a(".selecter").not(c.$selecter).trigger("close.selecter",[c])}function q(b){var c=b.data;if(13===b.keyCode)c.$selecter.hasClass("open")&&(l(b),r(c.index,c)),t(c);else if(!(9===b.keyCode||b.metaKey||b.altKey||b.ctrlKey||b.shiftKey)){b.preventDefault(),b.stopPropagation();var d=c.$items.length-1,e=c.index<0?0:c.index;if(a.inArray(b.keyCode,B?[38,40,37,39]:[38,40])>-1)e+=38===b.keyCode||B&&37===b.keyCode?-1:1,0>e&&(e=0),e>d&&(e=d);else{var f,g,h=String.fromCharCode(b.keyCode).toUpperCase();for(g=c.index+1;d>=g;g++)if(f=c.$options.eq(g).text().charAt(0).toUpperCase(),f===h){e=g;break}if(0>e||e===c.index)for(g=0;d>=g;g++)if(f=c.$options.eq(g).text().charAt(0).toUpperCase(),f===h){e=g;break}}e>=0&&(r(e,c),s(c))}}function r(a,b){var c=b.$items.eq(a),d=c.hasClass("selected"),e=c.hasClass("disabled");if(!e){if(-1===a&&""!==b.label)b.$selected.html(b.label);else if(d)b.multiple&&(b.$options.eq(a).prop("selected",null),c.removeClass("selected"));else{{var f=c.html();c.data("value")}b.multiple?b.$options.eq(a).prop("selected",!0):(b.$selected.html(f).removeClass("placeholder"),b.$items.filter(".selected").removeClass("selected"),b.$select[0].selectedIndex=a),c.addClass("selected")}b.multiple||(b.index=a)}}function s(b){var c=b.index>=0?b.$items.eq(b.index).position():{left:0,top:0};void 0!==a.fn.scroller?b.$itemsWrapper.scroller("scroll",b.$itemsWrapper.find(".scroller-content").scrollTop()+c.top,0).scroller("reset"):b.$itemsWrapper.scrollTop(b.$itemsWrapper.scrollTop()+c.top)}function t(a){a.links?u(a):(a.callback.call(a.$selecter,a.$select.val(),a.index),a.$select.trigger("change",[!0]))}function u(a){var c=a.$select.val();a.external?b.open(c):b.location.href=c}function v(a,b){return 0===b?a:a.length>b?a.substring(0,b)+"...":a}function w(a){return"string"==typeof a?a.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"):a}function x(a,b,c,d){return y(a,d),d===!0?setInterval(c,b):setTimeout(c,b)}function y(a){null!==a&&(clearInterval(a),a=null)}var z=0,A=b.navigator.userAgent||b.navigator.vendor||b.opera,B=/Firefox/i.test(A),C=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(A),D=B&&C,E=null,F={callback:a.noop,cover:!1,customClass:"",label:"",external:!1,links:!1,trim:0},G={defaults:function(b){return F=a.extend(F,b||{}),a(this)},disable:function(b){return a(this).each(function(c,d){var e=a(d).parent(".selecter").data("selecter");if(e)if("undefined"!=typeof b){var f=e.$items.index(e.$items.filter("[data-value="+b+"]"));e.$items.eq(f).addClass("disabled"),e.$options.eq(f).prop("disabled",!0)}else e.$selecter.hasClass("open")&&e.$selecter.find(".selecter-selected").trigger("click.selecter"),e.$selecter.addClass("disabled"),e.$select.prop("disabled",!0)})},enable:function(b){return a(this).each(function(c,d){var e=a(d).parent(".selecter").data("selecter");if(e)if("undefined"!=typeof b){var f=e.$items.index(e.$items.filter("[data-value="+b+"]"));e.$items.eq(f).removeClass("disabled"),e.$options.eq(f).prop("disabled",!1)}else e.$selecter.removeClass("disabled"),e.$select.prop("disabled",!1)})},destroy:function(){return a(this).each(function(b,c){var d=a(c).parent(".selecter").data("selecter");d&&(d.$selecter.hasClass("open")&&d.$selecter.find(".selecter-selected").trigger("click.selecter"),void 0!==a.fn.scroller&&d.$selecter.find(".selecter-options").scroller("destroy"),d.$select[0].tabIndex=d.tabIndex,d.$selected.remove(),d.$itemsWrapper.remove(),d.$selecter.off(".selecter"),d.$select.off(".selecter").removeClass("selecter-element").show().unwrap())})},refresh:function(){return a(this).each(function(b,c){var d=a(c).parent(".selecter").data("selecter");if(d){var f=d.index;d.$allOptions=d.$select.find("option, optgroup"),d.$options=d.$allOptions.filter("option"),d.index=-1,f=d.$options.index(d.$options.filter(":selected")),e(d),d.multiple||r(f,d)}})}};a.fn.selecter=function(a){return G[a]?G[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:c.apply(this,arguments)},a.selecter=function(a){"defaults"===a&&G.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,window);!function(a){"use strict";function b(b){b=a.extend({},l,b||{});for(var d=a(this),e=0,f=d.length;f>e;e++)c(d.eq(e),b);return d}function c(b,c){if(!b.hasClass("stepper-input")){c=a.extend({},c,b.data("stepper-options"));var f=parseFloat(b.attr("min")),g=parseFloat(b.attr("max")),h=parseFloat(b.attr("step"))||1;b.addClass("stepper-input").wrap('<div class="stepper '+c.customClass+'" />').after('<span class="stepper-arrow up">'+c.labels.up+'</span><span class="stepper-arrow down">'+c.labels.down+"</span>");var i=b.parent(".stepper"),k=a.extend({$stepper:i,$input:b,$arrow:i.find(".stepper-arrow"),min:void 0===typeof f||isNaN(f)?!1:f,max:void 0===typeof g||isNaN(g)?!1:g,step:void 0===typeof h||isNaN(h)?1:h,timer:null},c);k.digits=j(k.step),b.is(":disabled")&&i.addClass("disabled"),i.on("keypress",".stepper-input",k,d),i.on("touchstart.stepper mousedown.stepper",".stepper-arrow",k,e).data("stepper",k)}}function d(a){var b=a.data;(38===a.keyCode||40===a.keyCode)&&(a.preventDefault(),g(b,38===a.keyCode?b.step:-b.step))}function e(b){b.preventDefault(),b.stopPropagation(),f(b);var c=b.data;if(!c.$input.is(":disabled")&&!c.$stepper.hasClass("disabled")){var d=a(b.target).hasClass("up")?c.step:-c.step;c.timer=h(c.timer,125,function(){g(c,d,!1)}),g(c,d),a("body").on("touchend.stepper mouseup.stepper",c,f)}}function f(b){b.preventDefault(),b.stopPropagation();var c=b.data;i(c.timer),a("body").off(".stepper")}function g(a,b){var c=parseFloat(a.$input.val()),d=b;void 0===typeof c||isNaN(c)?d=a.min!==!1?a.min:0:a.min!==!1&&c<a.min?d=a.min:d+=c;var e=(d-a.min)%a.step;0!==e&&(d-=e),a.min!==!1&&d<a.min&&(d=a.min),a.max!==!1&&d>a.max&&(d-=a.step),d!==c&&(d=k(d,a.digits),a.$input.val(d).trigger("change"))}function h(a,b,c){return i(a),setInterval(c,b)}function i(a){a&&(clearInterval(a),a=null)}function j(a){var b=String(a);return b.indexOf(".")>-1?b.length-b.indexOf(".")-1:0}function k(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}var l={customClass:"",labels:{up:"Up",down:"Down"}},m={defaults:function(b){return l=a.extend(l,b||{}),a(this)},destroy:function(){return a(this).each(function(){var b=a(this).data("stepper");b&&(b.$stepper.off(".stepper").find(".stepper-arrow").remove(),b.$input.unwrap().removeClass("stepper-input"))})},disable:function(){return a(this).each(function(){var b=a(this).data("stepper");b&&(b.$input.attr("disabled","disabled"),b.$stepper.addClass("disabled"))})},enable:function(){return a(this).each(function(){var b=a(this).data("stepper");b&&(b.$input.attr("disabled",null),b.$stepper.removeClass("disabled"))})}};a.fn.stepper=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?this:b.apply(this,arguments)},a.stepper=function(a){"defaults"===a&&m.defaults.apply(this,Array.prototype.slice.call(arguments,1))}}(jQuery,this);var UNITS,csrfSafeMethod,csrftoken,getCookie;getCookie=function(name){var c,cookie,cookieValue,cookies,i,len;cookieValue=null;if(document.cookie&&document.cookie!==""){cookies=document.cookie.split(";");for(i=0,len=cookies.length;i<len;i++){cookie=cookies[i];c=$.trim(cookie);if(c.substring(0,name.length+1)===name+"="){cookieValue=decodeURIComponent(cookie.substring(name.length+2));break}}}return cookieValue};csrftoken=getCookie("csrftoken");csrfSafeMethod=function(method){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(method)};$.ajaxSetup({beforeSend:function(xhr,settings){if(!csrfSafeMethod(settings.type&&!this.crossDomain)){return xhr.setRequestHeader("X-CSRFToken",csrftoken)}}});if(typeof SI_UNITS!=="undefined"&&SI_UNITS!==null){UNITS={speed:SI_UNITS?"km/h":"mi/h",height:SI_UNITS?"m":"ft",distance:SI_UNITS?"km":"mi",temperature:SI_UNITS?"C":"F",per_min:"/ min",percent:"%"}}(function(root,factory){"use strict";var moment;if(typeof exports==="object"){try{moment=require("moment")}catch(e){}module.exports=factory(moment)}else if(typeof define==="function"&&define.amd){define(function(req){var id="moment";try{moment=req(id)}catch(e){}return factory(moment)})}else{root.Pikaday=factory(root.moment)}})(this,function(moment){"use strict";var hasMoment=typeof moment==="function",hasEventListeners=!!window.addEventListener,document=window.document,sto=window.setTimeout,addEvent=function(el,e,callback,capture){if(hasEventListeners){el.addEventListener(e,callback,!!capture)}else{el.attachEvent("on"+e,callback)}},removeEvent=function(el,e,callback,capture){if(hasEventListeners){el.removeEventListener(e,callback,!!capture)}else{el.detachEvent("on"+e,callback)}},fireEvent=function(el,eventName,data){var ev;if(document.createEvent){ev=document.createEvent("HTMLEvents");ev.initEvent(eventName,true,false);ev=extend(ev,data);el.dispatchEvent(ev)}else if(document.createEventObject){ev=document.createEventObject();ev=extend(ev,data);el.fireEvent("on"+eventName,ev)}},trim=function(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")},hasClass=function(el,cn){return(" "+el.className+" ").indexOf(" "+cn+" ")!==-1},addClass=function(el,cn){if(!hasClass(el,cn)){el.className=el.className===""?cn:el.className+" "+cn}},removeClass=function(el,cn){el.className=trim((" "+el.className+" ").replace(" "+cn+" "," "))},isArray=function(obj){return/Array/.test(Object.prototype.toString.call(obj))},isDate=function(obj){return/Date/.test(Object.prototype.toString.call(obj))&&!isNaN(obj.getTime())},isWeekend=function(date){var day=date.getDay();return day===0||day===6},isLeapYear=function(year){return year%4===0&&year%100!==0||year%400===0},getDaysInMonth=function(year,month){return[31,isLeapYear(year)?29:28,31,30,31,30,31,31,30,31,30,31][month]},setToStartOfDay=function(date){if(isDate(date))date.setHours(0,0,0,0)},compareDates=function(a,b){return a.getTime()===b.getTime()},extend=function(to,from,overwrite){var prop,hasProp;for(prop in from){hasProp=to[prop]!==undefined;if(hasProp&&typeof from[prop]==="object"&&from[prop]!==null&&from[prop].nodeName===undefined){if(isDate(from[prop])){if(overwrite){to[prop]=new Date(from[prop].getTime())}}else if(isArray(from[prop])){if(overwrite){to[prop]=from[prop].slice(0)}}else{to[prop]=extend({},from[prop],overwrite)}}else if(overwrite||!hasProp){to[prop]=from[prop]}}return to},adjustCalendar=function(calendar){if(calendar.month<0){calendar.year-=Math.ceil(Math.abs(calendar.month)/12);calendar.month+=12}if(calendar.month>11){calendar.year+=Math.floor(Math.abs(calendar.month)/12);calendar.month-=12}return calendar},defaults={field:null,bound:undefined,position:"bottom left",reposition:true,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:false,firstDay:0,minDate:null,maxDate:null,yearRange:10,showWeekNumber:false,minYear:0,maxYear:9999,minMonth:undefined,maxMonth:undefined,isRTL:false,yearSuffix:"",showMonthAfterYear:false,numberOfMonths:1,mainCalendar:"left",container:undefined,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},renderDayName=function(opts,day,abbr){day+=opts.firstDay;while(day>=7){day-=7}return abbr?opts.i18n.weekdaysShort[day]:opts.i18n.weekdays[day]},renderDay=function(d,m,y,isSelected,isToday,isDisabled,isEmpty){if(isEmpty){return'<td class="is-empty"></td>'}var arr=[];if(isDisabled){arr.push("is-disabled")}if(isToday){arr.push("is-today")}if(isSelected){arr.push("is-selected")}return'<td data-day="'+d+'" class="'+arr.join(" ")+'">'+'<button class="pika-button pika-day" type="button" '+'data-pika-year="'+y+'" data-pika-month="'+m+'" data-pika-day="'+d+'">'+d+"</button>"+"</td>"},renderWeek=function(d,m,y){var onejan=new Date(y,0,1),weekNum=Math.ceil(((new Date(y,m,d)-onejan)/864e5+onejan.getDay()+1)/7);return'<td class="pika-week">'+weekNum+"</td>"},renderRow=function(days,isRTL){return"<tr>"+(isRTL?days.reverse():days).join("")+"</tr>"},renderBody=function(rows){return"<tbody>"+rows.join("")+"</tbody>"},renderHead=function(opts){var i,arr=[];if(opts.showWeekNumber){arr.push("<th></th>")}for(i=0;i<7;i++){arr.push('<th scope="col"><abbr title="'+renderDayName(opts,i)+'">'+renderDayName(opts,i,true)+"</abbr></th>")}return"<thead>"+(opts.isRTL?arr.reverse():arr).join("")+"</thead>"},renderTitle=function(instance,c,year,month,refYear){var i,j,arr,opts=instance._o,isMinYear=year===opts.minYear,isMaxYear=year===opts.maxYear,html='<div class="pika-title">',monthHtml,yearHtml,prev=true,next=true;for(arr=[],i=0;i<12;i++){arr.push('<option value="'+(year===refYear?i-c:12+i-c)+'"'+(i===month?" selected":"")+(isMinYear&&i<opts.minMonth||isMaxYear&&i>opts.maxMonth?"disabled":"")+">"+opts.i18n.months[i]+"</option>")}monthHtml='<div class="pika-label">'+opts.i18n.months[month]+'<select class="pika-select pika-select-month">'+arr.join("")+"</select></div>";if(isArray(opts.yearRange)){i=opts.yearRange[0];j=opts.yearRange[1]+1}else{i=year-opts.yearRange;j=1+year+opts.yearRange}for(arr=[];i<j&&i<=opts.maxYear;i++){if(i>=opts.minYear){arr.push('<option value="'+i+'"'+(i===year?" selected":"")+">"+i+"</option>")}}yearHtml='<div class="pika-label">'+year+opts.yearSuffix+'<select class="pika-select pika-select-year">'+arr.join("")+"</select></div>";if(opts.showMonthAfterYear){html+=yearHtml+monthHtml}else{html+=monthHtml+yearHtml}if(isMinYear&&(month===0||opts.minMonth>=month)){prev=false}if(isMaxYear&&(month===11||opts.maxMonth<=month)){next=false}if(c===0){html+='<button class="pika-prev'+(prev?"":" is-disabled")+'" type="button">'+opts.i18n.previousMonth+"</button>"}if(c===instance._o.numberOfMonths-1){html+='<button class="pika-next'+(next?"":" is-disabled")+'" type="button">'+opts.i18n.nextMonth+"</button>"}return html+="</div>"},renderTable=function(opts,data){return'<table cellpadding="0" cellspacing="0" class="pika-table">'+renderHead(opts)+renderBody(data)+"</table>"},Pikaday=function(options){var self=this,opts=self.config(options);self._onMouseDown=function(e){if(!self._v){return}e=e||window.event;var target=e.target||e.srcElement;if(!target){return}if(!hasClass(target.parentNode,"is-disabled")){if(hasClass(target,"pika-button")&&!hasClass(target,"is-empty")){self.setDate(new Date(target.getAttribute("data-pika-year"),target.getAttribute("data-pika-month"),target.getAttribute("data-pika-day")));if(opts.bound){sto(function(){self.hide();if(opts.field){opts.field.blur()}},100)}return}else if(hasClass(target,"pika-prev")){self.prevMonth()}else if(hasClass(target,"pika-next")){self.nextMonth()}}if(!hasClass(target,"pika-select")){if(e.preventDefault){e.preventDefault()}else{e.returnValue=false;return false}}else{self._c=true}};self._onChange=function(e){e=e||window.event;var target=e.target||e.srcElement;if(!target){return}if(hasClass(target,"pika-select-month")){self.gotoMonth(target.value)}else if(hasClass(target,"pika-select-year")){self.gotoYear(target.value)}};self._onInputChange=function(e){var date;if(e.firedBy===self){return}if(hasMoment){date=moment(opts.field.value,opts.format);date=date&&date.isValid()?date.toDate():null}else{date=new Date(Date.parse(opts.field.value))}self.setDate(isDate(date)?date:null);if(!self._v){self.show()}};self._onInputFocus=function(){self.show()};self._onInputClick=function(){self.show()};self._onInputBlur=function(){var pEl=document.activeElement;do{if(hasClass(pEl,"pika-single")){return}}while(pEl=pEl.parentNode);if(!self._c){self._b=sto(function(){self.hide()},50)}self._c=false};self._onClick=function(e){e=e||window.event;var target=e.target||e.srcElement,pEl=target;if(!target){return}if(!hasEventListeners&&hasClass(target,"pika-select")){if(!target.onchange){target.setAttribute("onchange","return;");addEvent(target,"change",self._onChange)}}do{if(hasClass(pEl,"pika-single")||pEl===opts.trigger){return}}while(pEl=pEl.parentNode);if(self._v&&target!==opts.trigger&&pEl!==opts.trigger){self.hide()}};self.el=document.createElement("div");self.el.className="pika-single"+(opts.isRTL?" is-rtl":"")+(opts.theme?" "+opts.theme:"");addEvent(self.el,"ontouchend"in document?"touchend":"mousedown",self._onMouseDown,true);addEvent(self.el,"change",self._onChange);if(opts.field){if(opts.container){opts.container.appendChild(self.el)}else if(opts.bound){document.body.appendChild(self.el)}else{opts.field.parentNode.insertBefore(self.el,opts.field.nextSibling)}addEvent(opts.field,"change",self._onInputChange);if(!opts.defaultDate){if(hasMoment&&opts.field.value){opts.defaultDate=moment(opts.field.value,opts.format).toDate()}else{opts.defaultDate=new Date(Date.parse(opts.field.value))}opts.setDefaultDate=true}}var defDate=opts.defaultDate;if(isDate(defDate)){if(opts.setDefaultDate){self.setDate(defDate,true)}else{self.gotoDate(defDate)}}else{self.gotoDate(new Date)}if(opts.bound){this.hide();self.el.className+=" is-bound";addEvent(opts.trigger,"click",self._onInputClick);addEvent(opts.trigger,"focus",self._onInputFocus);addEvent(opts.trigger,"blur",self._onInputBlur)}else{this.show()}};Pikaday.prototype={config:function(options){if(!this._o){this._o=extend({},defaults,true)}var opts=extend(this._o,options,true);opts.isRTL=!!opts.isRTL;opts.field=opts.field&&opts.field.nodeName?opts.field:null;opts.theme=typeof opts.theme=="string"&&opts.theme?opts.theme:null;opts.bound=!!(opts.bound!==undefined?opts.field&&opts.bound:opts.field);opts.trigger=opts.trigger&&opts.trigger.nodeName?opts.trigger:opts.field;opts.disableWeekends=!!opts.disableWeekends;opts.disableDayFn=typeof opts.disableDayFn=="function"?opts.disableDayFn:null;var nom=parseInt(opts.numberOfMonths,10)||1;opts.numberOfMonths=nom>4?4:nom;if(!isDate(opts.minDate)){opts.minDate=false}if(!isDate(opts.maxDate)){opts.maxDate=false}if(opts.minDate&&opts.maxDate&&opts.maxDate<opts.minDate){opts.maxDate=opts.minDate=false}if(opts.minDate){this.setMinDate(opts.minDate)}if(opts.maxDate){setToStartOfDay(opts.maxDate);opts.maxYear=opts.maxDate.getFullYear();opts.maxMonth=opts.maxDate.getMonth()}if(isArray(opts.yearRange)){var fallback=(new Date).getFullYear()-10;opts.yearRange[0]=parseInt(opts.yearRange[0],10)||fallback;opts.yearRange[1]=parseInt(opts.yearRange[1],10)||fallback}else{opts.yearRange=Math.abs(parseInt(opts.yearRange,10))||defaults.yearRange;if(opts.yearRange>100){opts.yearRange=100}}return opts},toString:function(format){return!isDate(this._d)?"":hasMoment?moment(this._d).format(format||this._o.format):this._d.toDateString()
},getMoment:function(){return hasMoment?moment(this._d):null},setMoment:function(date,preventOnSelect){if(hasMoment&&moment.isMoment(date)){this.setDate(date.toDate(),preventOnSelect)}},getDate:function(){return isDate(this._d)?new Date(this._d.getTime()):null},setDate:function(date,preventOnSelect){if(!date){this._d=null;if(this._o.field){this._o.field.value="";fireEvent(this._o.field,"change",{firedBy:this})}return this.draw()}if(typeof date==="string"){date=new Date(Date.parse(date))}if(!isDate(date)){return}var min=this._o.minDate,max=this._o.maxDate;if(isDate(min)&&date<min){date=min}else if(isDate(max)&&date>max){date=max}this._d=new Date(date.getTime());setToStartOfDay(this._d);this.gotoDate(this._d);if(this._o.field){this._o.field.value=this.toString();fireEvent(this._o.field,"change",{firedBy:this})}if(!preventOnSelect&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},gotoDate:function(date){var newCalendar=true;if(!isDate(date)){return}if(this.calendars){var firstVisibleDate=new Date(this.calendars[0].year,this.calendars[0].month,1),lastVisibleDate=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),visibleDate=date.getTime();lastVisibleDate.setMonth(lastVisibleDate.getMonth()+1);lastVisibleDate.setDate(lastVisibleDate.getDate()-1);newCalendar=visibleDate<firstVisibleDate.getTime()||lastVisibleDate.getTime()<visibleDate}if(newCalendar){this.calendars=[{month:date.getMonth(),year:date.getFullYear()}];if(this._o.mainCalendar==="right"){this.calendars[0].month+=1-this._o.numberOfMonths}}this.adjustCalendars()},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(var c=1;c<this._o.numberOfMonths;c++){this.calendars[c]=adjustCalendar({month:this.calendars[0].month+c,year:this.calendars[0].year})}this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(month){if(!isNaN(month)){this.calendars[0].month=parseInt(month,10);this.adjustCalendars()}},nextMonth:function(){this.calendars[0].month++;this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--;this.adjustCalendars()},gotoYear:function(year){if(!isNaN(year)){this.calendars[0].year=parseInt(year,10);this.adjustCalendars()}},setMinDate:function(value){setToStartOfDay(value);this._o.minDate=value;this._o.minYear=value.getFullYear();this._o.minMonth=value.getMonth()},setMaxDate:function(value){this._o.maxDate=value},draw:function(force){if(!this._v&&!force){return}var opts=this._o,minYear=opts.minYear,maxYear=opts.maxYear,minMonth=opts.minMonth,maxMonth=opts.maxMonth,html="";if(this._y<=minYear){this._y=minYear;if(!isNaN(minMonth)&&this._m<minMonth){this._m=minMonth}}if(this._y>=maxYear){this._y=maxYear;if(!isNaN(maxMonth)&&this._m>maxMonth){this._m=maxMonth}}for(var c=0;c<opts.numberOfMonths;c++){html+='<div class="pika-lendar">'+renderTitle(this,c,this.calendars[c].year,this.calendars[c].month,this.calendars[0].year)+this.render(this.calendars[c].year,this.calendars[c].month)+"</div>"}this.el.innerHTML=html;if(opts.bound){if(opts.field.type!=="hidden"){sto(function(){opts.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){var self=this;sto(function(){self._o.onDraw.call(self)},0)}},adjustPosition:function(){if(this._o.container)return;var field=this._o.trigger,pEl=field,width=this.el.offsetWidth,height=this.el.offsetHeight,viewportWidth=window.innerWidth||document.documentElement.clientWidth,viewportHeight=window.innerHeight||document.documentElement.clientHeight,scrollTop=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,left,top,clientRect;if(typeof field.getBoundingClientRect==="function"){clientRect=field.getBoundingClientRect();left=clientRect.left+window.pageXOffset;top=clientRect.bottom+window.pageYOffset}else{left=pEl.offsetLeft;top=pEl.offsetTop+pEl.offsetHeight;while(pEl=pEl.offsetParent){left+=pEl.offsetLeft;top+=pEl.offsetTop}}if(this._o.reposition&&left+width>viewportWidth||this._o.position.indexOf("right")>-1&&left-width+field.offsetWidth>0){left=left-width+field.offsetWidth}if(this._o.reposition&&top+height>viewportHeight+scrollTop||this._o.position.indexOf("top")>-1&&top-height-field.offsetHeight>0){top=top-height-field.offsetHeight}this.el.style.cssText=["position: absolute","left: "+left+"px","top: "+top+"px"].join(";")},render:function(year,month){var opts=this._o,now=new Date,days=getDaysInMonth(year,month),before=new Date(year,month,1).getDay(),data=[],row=[];setToStartOfDay(now);if(opts.firstDay>0){before-=opts.firstDay;if(before<0){before+=7}}var cells=days+before,after=cells;while(after>7){after-=7}cells+=7-after;for(var i=0,r=0;i<cells;i++){var day=new Date(year,month,1+(i-before)),isSelected=isDate(this._d)?compareDates(day,this._d):false,isToday=compareDates(day,now),isEmpty=i<before||i>=days+before,isDisabled=opts.minDate&&day<opts.minDate||opts.maxDate&&day>opts.maxDate||opts.disableWeekends&&isWeekend(day)||opts.disableDayFn&&opts.disableDayFn(day);row.push(renderDay(1+(i-before),month,year,isSelected,isToday,isDisabled,isEmpty));if(++r===7){if(opts.showWeekNumber){row.unshift(renderWeek(i-before,month,year))}data.push(renderRow(row,opts.isRTL));row=[];r=0}}return renderTable(opts,data)},isVisible:function(){return this._v},show:function(){if(!this._v){removeClass(this.el,"is-hidden");this._v=true;this.draw();if(this._o.bound){addEvent(document,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function(){var v=this._v;if(v!==false){if(this._o.bound){removeEvent(document,"click",this._onClick)}this.el.style.cssText="";addClass(this.el,"is-hidden");this._v=false;if(v!==undefined&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function(){this.hide();removeEvent(this.el,"mousedown",this._onMouseDown,true);removeEvent(this.el,"change",this._onChange);if(this._o.field){removeEvent(this._o.field,"change",this._onInputChange);if(this._o.bound){removeEvent(this._o.trigger,"click",this._onInputClick);removeEvent(this._o.trigger,"focus",this._onInputFocus);removeEvent(this._o.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return Pikaday});var bestSplitGeneric,bestSplitSpeed,changeSummary,convertTrack,createCadChart,createCadZones,createChart,createElevationChart,createElevationZones,createGradeChart,createGradeZones,createHrChart,createHrZones,createMap,createOchart,createSpeedChart,createSpeedZones,createTempChart,createTempZones,createWchart,createZones,findBestSplits,formatDistance,formatShortDistance,formatSpeed,formatTime,getActivityId,getBounds,groupData,initialSum,movePointerEvent,parseSplitArgs,pointer,points,round_,setMovePointerEvent,toSIBase,updateTooltip;round_=function(value,places){var multi;if(places==null){places=2}multi=Math.pow(10,places);return Math.round(value*multi)/multi};updateTooltip=function(x){var chart,k,len,ref,results;ref=Highcharts.charts;results=[];for(k=0,len=ref.length;k<len;k++){chart=ref[k];chart.tooltip.refresh([chart.series[0].points[x]]);results.push(chart.series[0].data[x].setState("hover"))}return results};getActivityId=function(){var url;url=document.location.pathname.split("/");return url[url.length-1]};groupData=function(data){var count,i,increment,k,len,local_max,max,min,new_data,point;min=data[0][0];max=data[data.length-1][0];increment=Math.ceil((max-min)/25);local_max=min+increment;new_data=[];i=0;count=0;for(k=0,len=data.length;k<len;k++){point=data[k];if(local_max<point[0]){i+=1;local_max+=increment}count+=point[1];if(new_data[i]!=null){new_data[i][1]+=point[1]}else{new_data[i]=[];new_data[i][0]=local_max-increment;new_data[i][1]=point[1]}}return[new_data,count]};toSIBase=function(value,units){var multi;multi=1;if(units.charAt(0)==="k"){multi*=1e3}if(units==="mile"){multi*=1609}if(units==="ft"){multi*=.3048}if(units==="min"){multi*=60}if(units==="h"){multi*=3600}return value*multi};formatTime=function(value,has_seconds){var hours,minutes,seconds,str_min,str_sec;if(has_seconds==null){has_seconds=false}seconds=value%60;minutes=Math.floor(value/60)%60;hours=Math.floor(value/3600);str_min=minutes<10?"0"+minutes:""+minutes;if(!has_seconds){return hours+":"+str_min}else{str_sec=seconds<10?"0"+seconds:""+seconds;return hours+":"+str_min+":"+str_sec}};formatDistance=function(value){var d_str,multi,round_precision,val;if(SI_UNITS){multi=1/1e3}else{multi=1/1609}val=value*multi;round_precision=val<1?2:1;d_str=round_(value*multi,round_precision);return d_str+" "+UNITS.distance};formatShortDistance=function(value){var d_str,multi;if(SI_UNITS){multi=1}else{multi=3.281}d_str=round_(value*multi,0);return d_str+" "+UNITS.height};formatSpeed=function(value){var multi,s_str;if(SI_UNITS){multi=3.6}else{multi=2.237}s_str=round_(value*multi,1);return s_str+" "+UNITS.speed};createOchart=function(data,height){var e,multi_speed;if(height==null){height=200}multi_speed=SI_UNITS?3.6:2.237;data[1]=function(){var k,len,ref,results;ref=data[1];results=[];for(k=0,len=ref.length;k<len;k++){e=ref[k];results.push([e[0],round_(e[1]*multi_speed,2)])}return results}();if(!SI_UNITS){data[0]=function(){var k,len,ref,results;ref=data[0];results=[];for(k=0,len=ref.length;k<len;k++){e=ref[k];results.push([e[0],round_(e[1]*3.281,0)])}return results}()}return $("#ochart").highcharts({chart:{height:height},credits:{enabled:false},legend:{enabled:false},title:{text:null},plotOptions:{series:{point:{events:{mouseOver:function(event){return movePointerEvent(this.index)}}}}},tooltip:{shared:true,crosshairs:true,formatter:function(){var distance,elevation,speed;distance=this.x/1e3+(" "+UNITS.distance);elevation=this.points[0].y+(" "+UNITS.height);speed=this.points[1].y+(" "+UNITS.speed);return"<b>"+distance+"</b><br>Elevation: "+elevation+"<br>Speed: "+speed}},series:[{name:"Elevation",data:data[0],yAxis:0},{name:"Speed",data:data[1],yAxis:1}],xAxis:{labels:{formatter:function(){return this.value/1e3+(" "+UNITS.distance)}}},yAxis:[{id:0,title:{enabled:false},labels:{formatter:function(){return this.value+(" "+UNITS.height)}}},{id:1,min:0,labels:{align:"left",formatter:function(){return this.value+(" "+UNITS.speed)}},opposite:true,title:{enabled:false}}]})};createChart=function(target,name,color,data,units){var v;return $(target).highcharts({chart:{height:150},colors:[color],credits:{enabled:false},legend:{enabled:false},plotOptions:{series:{point:{events:{mouseOver:function(event){return updateTooltip(this.index)}}}}},title:{text:name,floating:true},tooltip:{shared:true,crosshairs:true,formatter:function(){var distance,val;distance=round_(this.x/1e3,2)+(" "+UNITS.distance);val=this.points[0].y+(" "+units);return"<b>"+distance+"</b><br>"+name+": "+val}},series:[{name:name,data:data}],xAxis:{labels:{formatter:function(){return this.value/1e3+(" "+UNITS.distance)}}},yAxis:[{id:0,min:Math.min.apply(null,function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){v=data[k];results.push(v[1])}return results}()),title:{enabled:false},labels:{formatter:function(){return this.value+(" "+units)}}}]})};createElevationChart=function(data){var e;if(!SI_UNITS){data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*3.281,0)])}return results}()}return createChart("#elevation_chart","Elevation","red",data,UNITS.height)};createSpeedChart=function(data){var e,multi_speed;multi_speed=SI_UNITS?3.6:2.237;data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*multi_speed,2)])}return results}();return createChart("#speed_chart","Speed","green",data,UNITS.speed)};createGradeChart=function(data){return createChart("#grade_chart","Grade","blue",data,UNITS.percent)};createHrChart=function(data){return createChart("#hr_chart","Heart rate","orange",data,UNITS.per_min)};createCadChart=function(data){return createChart("#cad_chart","Cadence","pink",data,UNITS.per_min)};createTempChart=function(data){var e;if(!SI_UNITS){data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*1.8+32,0)])}return results}()}return createChart("#temp_chart","Temperature","purple",data,UNITS.temperature)};createZones=function(target,name,color,data,units){var count,i,k,len,ref,val;ref=groupData(data),data=ref[0],count=ref[1];for(i=k=0,len=data.length;k<len;i=++k){val=data[i];data[i][1]=val[1]/count*100}return $(target).highcharts({chart:{type:"column",height:200},colors:[color],credits:{enabled:false},legend:{enabled:false},title:{text:name,floating:true},tooltip:{shared:true,crosshairs:true,formatter:function(){var percent;val=this.x+(" "+units);percent=round_(this.points[0].y,2)+" %";return"<b>"+val+"</b><br>"+percent}},series:[{name:name,data:data}],xAxis:{labels:{formatter:function(){return this.value+(" "+units)}}},yAxis:[{id:0,title:{enabled:false},labels:{formatter:function(){return this.value+" %"}}}]})};createElevationZones=function(data){var e;if(!SI_UNITS){data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*3.281,0)])}return results}()}return createZones("#elevation_zones","Elevation","red",data,UNITS.height)};createSpeedZones=function(data){var e,multi_speed;multi_speed=SI_UNITS?3.6:2.237;data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*multi_speed,2)])}return results}();return createZones("#speed_zones","Speed","green",data,UNITS.speed)};createGradeZones=function(data){return createZones("#grade_zones","Grade","blue",data,UNITS.percent)};createHrZones=function(data){return createZones("#hr_zones","Heart rate","orange",data,UNITS.per_min)};createCadZones=function(data){return createZones("#cad_zones","Cadence","pink",data,UNITS.per_min)};createTempZones=function(data){var e;if(!SI_UNITS){data=function(){var k,len,results;results=[];for(k=0,len=data.length;k<len;k++){e=data[k];results.push([e[0],round_(e[1]*1.8+32,0)])}return results}()}return createZones("#temp_zones","Temperature","purple",data,UNITS.temperature)};convertTrack=function(points){var extremes,k,latLng,len,point,x,y;latLng=[];extremes={x:{min:180,max:-180},y:{min:90,max:-90}};for(k=0,len=points.length;k<len;k++){point=points[k];x=point[0];y=point[1];latLng.push(new google.maps.LatLng(x,y));if(x<extremes.x.min){extremes.x.min=x}else if(x>extremes.x.max){extremes.x.max=x}if(y<extremes.y.min){extremes.y.min=y}else if(y>extremes.y.max){extremes.y.max=y}}return{extremes:extremes,points:latLng}};getBounds=function(extremes){var bounds,max,min;bounds=new google.maps.LatLngBounds;min=new google.maps.LatLng(extremes.x.min,extremes.y.min);max=new google.maps.LatLng(extremes.x.max,extremes.y.max);bounds.extend(min);bounds.extend(max);return bounds};points=null;pointer=null;setMovePointerEvent=function(ptr,pts){pointer=ptr;return points=pts};movePointerEvent=function(index){if(!pointer||!points){return}return pointer.setPosition(points[index])};createMap=function(data){var bounds,center,map,marker,polyline,track;track=convertTrack(data);center=new google.maps.LatLng((track.extremes.x.max+track.extremes.x.min)/2,(track.extremes.y.max+track.extremes.y.min)/2);bounds=getBounds(track.extremes);map=new google.maps.Map(document.getElementById("map"),{zoom:10,center:center,mapTypeId:google.maps.MapTypeId.TERRAIN});map.fitBounds(bounds);polyline=new google.maps.Polyline({path:track.points,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:4,editable:false});polyline.setMap(map);marker=new google.maps.Marker({icon:{path:google.maps.SymbolPath.CIRCLE,scale:7,fillColor:"#6CC9EB",fillOpacity:1,strokeColor:"#FFFFFF",strokeOpacity:1,strokeWeight:2}});setMovePointerEvent(marker,track.points);return marker.setMap(map)};findBestSplits=function(data){return $("td[data-best-split]").each(function(){var args,interval,ref,si_val;args=parseSplitArgs($(this).attr("data-best-split"));if((ref=args.what)==="cad"||ref==="hr"||ref==="elevation"){interval=args.type==="distance"?args.interval*100:args.interval;si_val=bestSplitGeneric(data[args.type],data[args.what],interval,false);return $(this).text(args.what==="elevation"?formatShortDistance(si_val):si_val)}else if(args.what==="speed"){interval=args.type==="distance"?args.interval*100:args.interval;si_val=bestSplitSpeed(data.time,data.distance,interval,args.type==="time");return $(this).text(formatSpeed(si_val))}else{interval=args.type==="distance"?args.interval*100:args.interval;si_val=bestSplitGeneric(data[args.type],data[args.what],interval,true,args.type==="distance");return $(this).text(args.type==="time"?formatDistance(si_val/100):formatTime(si_val,true))}})};parseSplitArgs=function(str){var attrs,interval,ref;attrs=str.split("-");interval=toSIBase(parseFloat(attrs[1]),attrs[2]);return{what:attrs[0],type:(ref=attrs[2])==="s"||ref==="min"||ref==="h"?"time":"distance",interval:interval}};bestSplitGeneric=function(control,data,interval,as_delta,prefer_min){var best,choose_best,current,d,delta,i,j,k,len,prev,ref,ref1,start;if(as_delta==null){as_delta=true}if(prefer_min==null){prefer_min=false}choose_best=prefer_min?Math.min:Math.max;best=prefer_min?Number.MAX_VALUE:0;ref=initialSum(control,data,interval,as_delta),start=ref[0],delta=ref[1],current=ref[2];prev=data[start-1];j=0;ref1=data.slice(start);for(i=k=0,len=ref1.length;k<len;i=++k){d=ref1[i];if(as_delta){current+=d}else{current+=d-prev;prev=d}delta+=control[i+start];if(delta>interval){best=choose_best(current,best);while(delta>interval){if(as_delta){current-=data[j]}else{current-=data[j-1]?data[j]-data[j-1]:0}delta-=control[j];j+=1}}}return best};bestSplitSpeed=function(time,distance,interval,interval_time){var best,c,c_dist,c_time,control,delta,i,j,k,len,ref,ref1,start;if(interval_time==null){interval_time=true}best=0;control=interval_time?time:distance;ref=initialSum(control,distance,interval,true),start=ref[0],delta=ref[1],c_dist=ref[2];c_time=initialSum(control,time,interval,true)[2];j=0;ref1=control.slice(start);for(i=k=0,len=ref1.length;k<len;i=++k){c=ref1[i];c_time+=time[i+start];c_dist+=distance[i+start];delta+=c;if(delta>interval){best=Math.max(round_(c_dist/c_time/100,1),best);while(delta>interval){c_time-=time[j];c_dist-=distance[j];delta-=control[j];j+=1}}}return best};initialSum=function(control,data,interval,as_delta){var delta,i,prev,sum;if(as_delta==null){as_delta=true}sum=0;delta=0;i=0;prev=data[0];while(delta<interval&&i<data.length){i+=1;if(as_delta){sum+=data[i]}else{sum+=data[i]-prev;prev=data[i]}delta+=control[i]}return[i,delta,sum]};changeSummary=function(){var period;period=$("#summary_for").val();return $.getJSON("/activities/api/summary/"+period,function(json){var results,target,value;results=[];for(target in json){value=json[target];switch(target){case"total_time":results.push($("#"+target).text(formatTime(value)));break;case"longest":results.push($("#"+target).text(formatTime(value)));break;case"avg_duration":results.push($("#"+target).text(formatTime(value)));break;case"farthest":results.push($("#"+target).text(formatDistance(value)));break;case"total_distance":results.push($("#"+target).text(formatDistance(value)));break;case"avg_distance":results.push($("#"+target).text(formatDistance(value)));break;case"max_speed":results.push($("#"+target).text(formatSpeed(value/360)));break;case"avg_speed":results.push($("#"+target).text(formatSpeed(value)));break;case"elev_gain":results.push($("#"+target).text(formatShortDistance(value)));break;default:results.push($("#"+target).text(value!==null?value:0))}}return results})};createWchart=function(data){return $("#wchart").highcharts({chart:{type:"column",height:300},credits:{enabled:false},legend:{enabled:false},title:{text:name,floating:true},tooltip:{shared:true,crosshairs:true,formatter:function(){return"<b>Dist</b>: "+this.points[0].y/1e3+" "+UNITS.distance+"<br><b>Time</b>: "+formatTime(this.points[1].y)+"<br><b>Rating</b>: "+this.points[2].y+"<br><b>#</b>: "+this.points[3].y}},series:[{name:"Distance",data:data.distance,yAxis:0},{name:"Time",data:data.time,yAxis:1},{name:"Rating",data:data.rating,yAxis:2},{name:"N",data:data.n,yAxis:3}],xAxis:{labels:{formatter:function(){return this.value}}},yAxis:[{id:0,title:{text:"Distance",enabled:false},labels:{enabled:false,formatter:function(){return this.value/1e3+(" "+UNITS.distance)}}},{id:1,title:{text:"Time",enabled:false},labels:{enabled:false,formatter:function(){return formatTime(this.value)}}},{id:2,opposite:true,title:{text:"Rating",enabled:false},labels:{enabled:false,formatter:function(){return this.value}}},{id:3,opposite:true,title:{text:"#",enabled:false},labels:{enabled:false,forrmatter:function(){return this.value}}}]})};$(function(){var id;$("select").selecter();$('[data-toggle="tooltip"]').tooltip();id=getActivityId();$('[data-action="delete-activity"]').click(function(e){if(!confirm("Are you sure you want to delete this activity?")){return e.preventDefault()}});if($("#id_date").length){new Pikaday({field:$("#id_date")[0],format:"YYYY-MM-DD"})}if($("#map").length){$.getJSON("/activities/api/map/"+id,function(json){return createMap(json)})}if($(".bm-nav").length){$.getJSON("/activities/api/ochart/"+id,function(json){return createOchart(json,150)})}else if($("#ochart").length){$.getJSON("/activities/api/ochart/"+id,function(json){return createOchart(json)})}if($("#elevation_chart").length){$.getJSON("/activities/api/chart/"+id+"/elevation",function(json){return createElevationChart(json)})}if($("#speed_chart").length){$.getJSON("/activities/api/chart/"+id+"/speed",function(json){return createSpeedChart(json)})}if($("#grade_chart").length){$.getJSON("/activities/api/chart/"+id+"/grade",function(json){return createGradeChart(json)})}if($("#hr_chart").length){$.getJSON("/activities/api/chart/"+id+"/hr",function(json){return createHrChart(json)})}if($("#cad_chart").length){$.getJSON("/activities/api/chart/"+id+"/cadence",function(json){return createCadChart(json)})}if($("#temp_chart").length){$.getJSON("/activities/api/chart/"+id+"/temperature",function(json){return createTempChart(json)})}if($("#elevation_zones").length){$.getJSON("/activities/api/zones/"+id+"/elevation",function(json){return createElevationZones(json)})}if($("#speed_zones").length){$.getJSON("/activities/api/zones/"+id+"/speed",function(json){return createSpeedZones(json)})}if($("#grade_zones").length){$.getJSON("/activities/api/zones/"+id+"/grade",function(json){return createGradeZones(json)})}if($("#hr_zones").length){$.getJSON("/activities/api/zones/"+id+"/hr",function(json){return createHrZones(json)})}if($("#cad_zones").length){$.getJSON("/activities/api/zones/"+id+"/cadence",function(json){return createCadZones(json)})}if($("#temp_zones").length){$.getJSON("/activities/api/zones/"+id+"/temperature",function(json){return createTempZones(json)})}if($("td[data-best-split]").length){$.getJSON("/activities/api/track/"+id,function(json){return findBestSplits(json)})}if($("#summary_for").length){changeSummary();$("#summary_for").change(changeSummary)}if($("#wchart").length){return $.getJSON("/activities/api/wchart",function(json){return createWchart(json)})}});$(function(){var check_pass;$(".settings form").submit(false);$('[data-action="default"]').change(function(){var field;field=$(this);return $.ajax({url:"/settings/save/"+this.id,method:"PUT",data:{value:field.val()},success:function(data,textStatus,jqXHR){var marker;if(data.success){marker=field.closest(".row").find(".saved");marker.addClass("active");return setTimeout(function(){return marker.removeClass("active")},2e3)}}})});check_pass=function(){var cpass,pass1,pass2;cpass=$("#cpasswd").val();pass1=$("#npasswd1").val();pass2=$("#npasswd2").val();return cpass!==""&&pass1!==""&&pass1===pass2};$('input[type="password"]').change(function(){if(check_pass()){return $('button[data-action="set-passwd"]').removeAttr("disabled")}else{return $('button[data-action="set-passwd"]').attr("disabled","")}});$('button[data-action="set-passwd"]').click(function(){var cpass,pass1,pass2;cpass=$("#cpasswd").val();pass1=$("#npasswd1").val();pass2=$("#npasswd2").val();return $.ajax({url:"/settings/save/password",method:"PUT",data:{current:cpass,new:pass1},success:function(data,textStatus,jqXHR){var marker;$(".text-danger").addClass("hidden");if(data.success){marker=field.closest(".row").find(".saved");marker.addClass("active");return setTimeout(function(){return marker.removeClass("active")},2e3)}else{return $("."+data.reason).removeClass("hidden")}}})});$('[data-action="avatar"]').click(function(){var data;data=new FormData;data.append("avatar",$('[name="avatar"]')[0].files[0]);$.ajax({url:"/settings/save/avatar",method:"POST",data:data,cache:false,processData:false,contentType:false,success:function(data,textStatus,jqXHR){return location.reload()}});return false});return $('[data-action="goals"]').change(function(){var field,params;field=$(this);params=this.name.split("_");return $.ajax({url:"/goals/set/"+params[0],data:{objective:params[1],value:field.val()},method:"PUT",success:function(data,textStatus,jqXHR){return console.log(data)}})})});$(function(){return $("[data-tc]").change(function(){var i,j,len,multies,total,v,val,vals;multies=[3600,60,1];vals=[$("#id_time_hrs").val(),$("#id_time_min").val(),$("#id_time_sec").val()];total=0;for(i=j=0,len=vals.length;j<len;i=++j){val=vals[i];v=val?parseInt(val):0;total+=v*multies[i]}return $("#id_elapsed").val(total)})});